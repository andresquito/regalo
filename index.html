<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pedido Camisetas</title>

  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
</head>

<body>

<div class="container">

  <h2>Realiza tu pedido</h2>

  <!-- TALLA -->
  <label>Talla</label>
  <div class="tallas">
    <button type="button" class="talla-btn" onclick="seleccionarTalla(this,'S')">Peque√±a</button>
    <button type="button" class="talla-btn" onclick="seleccionarTalla(this,'M')">Mediana</button>
    <button type="button" class="talla-btn" onclick="seleccionarTalla(this,'L')">Grande</button>
  </div>
  <input type="hidden" id="talla">

  <!-- COLORES -->
  <label>Colores del pack</label>
  <div class="colores-pack">
    <select id="c1" class="color-select" onchange="cambiarEstiloColor(this)">
      <option value="">Color 1</option>
      <option value="Blanco" data-color="#ffffff">Blanco</option>
      <option value="Negro" data-color="#000000">Negro</option>
      <option value="Vino" data-color="#6b1b1b">Vino</option>
      <option value="Turquesa" data-color="#2bbec3">Turquesa</option>
    </select>

    <select id="c2" class="color-select" onchange="cambiarEstiloColor(this)">
      <option value="">Color 2</option>
      <option value="Blanco" data-color="#ffffff">Blanco</option>
      <option value="Negro" data-color="#000000">Negro</option>
      <option value="Vino" data-color="#6b1b1b">Vino</option>
      <option value="Turquesa" data-color="#2bbec3">Turquesa</option>
    </select>

    <select id="c3" class="color-select" onchange="cambiarEstiloColor(this)">
      <option value="">Color 3</option>
      <option value="Blanco" data-color="#ffffff">Blanco</option>
      <option value="Negro" data-color="#000000">Negro</option>
      <option value="Vino" data-color="#6b1b1b">Vino</option>
      <option value="Turquesa" data-color="#2bbec3">Turquesa</option>
    </select>
  </div>

  <!-- FECHA Y HORA -->
  <label>Fecha de entrega</label>
  <input type="date" id="fecha">

  <label>Hora de entrega</label>
  <input type="time" id="hora">

  <!-- UBICACI√ìN -->
  <label>Ubicaci√≥n de entrega</label>

  <button type="button" class="gps-btn" onclick="usarUbicacion()">
    üìç Usar mi ubicaci√≥n actual
  </button>

  <div id="ubicacionStatus">A√∫n no se ha seleccionado ubicaci√≥n</div>

  <div id="map" style="display:none;"></div>

  <input type="hidden" id="ubicacion">

  <!-- ENVIAR -->
  <button onclick="enviar()">Enviar pedido por WhatsApp</button>

</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
let map, marker;

/* TALLA */
function seleccionarTalla(btn, val) {
  document.querySelectorAll('.talla-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  talla.value = val;
}

/* COLORES */
function cambiarEstiloColor(select) {
  const color = select.options[select.selectedIndex].dataset.color;
  if (!color) return;

  select.style.backgroundColor = color;
  select.style.border = '2px solid ' + color;
  select.style.color = (color === '#000000' || color === '#6b1b1b') ? '#fff' : '#000';
}

/* UBICACI√ìN GPS */
function usarUbicacion() {
  if (!navigator.geolocation) {
    alert('Tu navegador no soporta GPS');
    return;
  }

  navigator.geolocation.getCurrentPosition(pos => {
    mostrarMapa(pos.coords.latitude, pos.coords.longitude);
  }, () => {
    alert('Debes permitir el acceso a tu ubicaci√≥n');
  });
}

function mostrarMapa(lat, lng) {
  document.getElementById('map').style.display = 'block';

  if (!map) {
    map = L.map('map').setView([lat, lng], 16);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

    marker = L.marker([lat, lng], { draggable: true }).addTo(map);

    marker.on('dragend', actualizarUbicacion);
  } else {
    map.setView([lat, lng], 16);
    marker.setLatLng([lat, lng]);
  }

  actualizarUbicacion();
}

function actualizarUbicacion() {
  const pos = marker.getLatLng();
  const link = `https://maps.google.com/?q=${pos.lat},${pos.lng}`;
  ubicacion.value = link;
  ubicacionStatus.innerText = '‚úÖ Ubicaci√≥n seleccionada (puedes mover el marcador si deseas)';
}

/* VALIDACI√ìN FINAL */
function enviar() {
  let faltan = [];

  if (!talla.value) faltan.push('talla');
  if (!c1.value || !c2.value || !c3.value) faltan.push('los 3 colores');
  if (!fecha.value) faltan.push('fecha');
  if (!hora.value) faltan.push('hora');
  if (!ubicacion.value) faltan.push('ubicaci√≥n');

  if (faltan.length) {
    alert('‚ùå Falta seleccionar:\n- ' + faltan.join('\n- '));
    return;
  }

  const msg =
    `Pedido Camisetas%0A` +
    `Talla: ${talla.value}%0A` +
    `Colores: ${c1.value}, ${c2.value}, ${c3.value}%0A` +
    `Fecha: ${fecha.value}%0A` +
    `Hora: ${hora.value}%0A` +
    `Ubicaci√≥n: ${ubicacion.value}`;

  window.open(`https://wa.me/593987259001?text=${msg}`, '_blank');
}
</script>

</body>
</html>







